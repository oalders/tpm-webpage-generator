<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/2000/REC-xhtml1-20000126/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

	<head>
		<title>Code: another_apache_registry_test</title>
		<link rel="Stylesheet" href="styles.css" type="text/css">
	</head>

	<body class="codepage">
		<blockquote>
			<p class="codepage"><tt>#!/usr/bin/perl -w<br>
			<br>
			use strict;<br>
			use CGI;<br>
			<br>
			my $cgi = CGI-&gt;new();<br>
			<br>
			my $security_level;<br>
			<br>
			print $cgi-&gt;header('text/html');<br>
			<br>
			print qq{<br>
			&lt;HTML&gt;<br>
			<br>
			&lt;HEAD&gt;<br>
			<br>
			&lt;TITLE&gt;<br>
			Testing a Perl CGI program run through mod_perl's Apache::Registry<br>
			&lt;/TITLE&gt;<br>
			<br>
			&lt;/HEAD&gt;<br>
			<br>
			&lt;BODY&gt;<br>
			<br>
			&lt;H1&gt;<br>
			Testing a Perl CGI program run through mod_perl's Apache::Registry<br>
			&lt;/H1&gt;<br>
			};<br>
			<br>
			display_based_on_security();<br>
			<br>
			&nbsp; &nbsp; print qq{<br>
			&lt;/BODY&gt;<br>
			<br>
			&lt;/HTML&gt;<br>
			};<br>
			<br>
			if ( cookie_check($cgi-&gt;cookie('secret_agent_name')) ) {<br>
			<br>
			&nbsp; &nbsp; $security_level = authorize_user();<br>
			<br>
			}<br>
			<br>
			exit 0;<br>
			<br>
			sub display_based_on_security {<br>
			<br>
			&nbsp; &nbsp; my %params = @_;<br>
			<br>
			&nbsp; &nbsp; if ( is_authorized($security_level)) {<br>
			<br>
			&nbsp; &nbsp; foreach my $i( 0 .. 9 ) {<br>
			&nbsp; &nbsp; &nbsp; &nbsp; print &quot;The super-secret number is : $i\n&lt;br&gt;&quot;<br>
			&nbsp; &nbsp; }<br>
			<br>
			&nbsp; &nbsp; } else {<br>
			<br>
			&nbsp; &nbsp; print qq{<br>
			&lt;BLINK&gt;&lt;H1&gt;INTRUDER ALERT!!&lt;/H1&gt;&lt;/BLINK&gt;<br>
			};<br>
			<br>
			&nbsp; &nbsp; }<br>
			<br>
			}<br>
			<br>
			sub is_authorized {<br>
			<br>
			&nbsp; &nbsp; return $_[0];<br>
			<br>
			}<br>
			<br>
			sub authorize_user {<br>
			<br>
			&nbsp; &nbsp; return 1;<br>
			<br>
			}<br>
			<br>
			sub cookie_check {<br>
			<br>
			&nbsp; &nbsp; return 1;<br>
			<br>
			}<br>
			 </tt></p>
		</blockquote>
	</body>

</html>
